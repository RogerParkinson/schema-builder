<?xml version="1.0" encoding="UTF-8"?>
<project name="xjc_generated" default="generateObjectsFromXSD" basedir="." xmlns:ivy="urn:ivy-ant">
	
	<tstamp />
	<property file="build.properties"/>


	<target name="generateObjectsFromXSD">
		<taskdef name="xjc" classname="org.jvnet.jaxb2_commons.xjc.XJC2Task">
		  <classpath>
		  	<fileset dir="${basedir}/temp/lib" includes="*.jar" />
		  </classpath>
		</taskdef>
		<delete dir="${basedir}/generated" failonerror="false"/>
		<mkdir dir="${basedir}/generated"/>
		<xjc extension="true" destdir="${basedir}/generated" binding="${xjbfile}">
			<arg line="-verbose -Xequals -XtoString -XhashCode -Xannotate -Xhyperjaxb3-ejb"/>
			<schema dir=".">
			 	<include name="${xsdfile}"/>
			</schema>
		</xjc>
	</target>

	<target name="schemaBuilder">
		<taskdef name="schemaBuilder" classname="nz.co.senanque.schemabuilder.SchemaBuilderTask">
		  <classpath>
		  	<fileset dir="${basedir}/temp/lib" includes="*.jar" />
		  	<fileset dir="${basedir}/temp/results" includes="*.jar" />
		  </classpath>
		</taskdef>
		<schemaBuilder 
				driver="${jdbc.driver}" 
				jdbcURL="${jdbc.url}" 
				user="${dbuser}" 
				password="${dbpassword}"
				outFileName="${basedir}/temp/generated.xsd"
				/>
	</target>
	<path id="toolslib">
		<fileset dir="temp/buildlib"/>
		<fileset dir="temp/lib"/>
	</path>
	<taskdef name="hibernatetool" 
	         classname="org.hibernate.tool.ant.HibernateToolTask" 
	         classpathref="toolslib" />

    <target name="genschema" description="Exports a generated schema to DB and file">  
        <hibernatetool destdir="temp">  
        	<jpaconfiguration persistenceunit="org.example.sandbox"/>
        	 <classpath>
        	  <path location="bin" />
        	 </classpath>
        	 <!-- list exporters here -->
            <hbm2ddl create="true" export="true" outputfilename="database-ddl.sql" delimiter=";" format="true" />  
        </hibernatetool>  
    </target>

</project>
